% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap.R
\name{bootstrap-methods}
\alias{bootstrap-methods}
\title{Bootstrap Methods for Functional Quantile GAM}
\description{
This file implements bootstrap procedures for inference in functional quantile
regression models for longitudinal data. Two bootstrap schemes are provided:
\enumerate{
\item \strong{Block Bootstrap} (\code{boot_pred_block}): Resamples complete subject
trajectories with replacement. This preserves the within-subject dependence
structure and is used primarily for \strong{variance estimation} and construction
of standard errors.
\item \strong{Wild Bootstrap} (\code{boot_pred_wild}): Combines standard resampling of
estimated random effects with wild bootstrap of residuals. This method is
used primarily for \strong{bias adjustment} of the estimators.
}
}
\section{Theoretical Background}{


The functional quantile regression model is:
\deqn{Q_{Y_{ij}|X_{ij}, u_i}^\tau(t_{ij}) = \alpha^\tau(t_{ij}) + 
      \int_S \beta^\tau(s, t_{ij}) X_{ij}(s) ds + u_i}

where:
\itemize{
\item \eqn{\tau \in (0,1)} is the quantile level
\item \eqn{\alpha^\tau(t)} is the time-varying intercept
\item \eqn{\beta^\tau(s,t)} is the bivariate functional coefficient
\item \eqn{X_{ij}(s)} are functional covariates observed on domain \eqn{S}
\item \eqn{u_i} are subject-specific random intercepts with \eqn{E[u_i] = 0}
}
}

\section{Why Two Bootstrap Methods}{


As documented in Battagliola et al. (2022), estimators in quantile regression
for longitudinal data can be biased when clusters are small. The bias arises
from a combination of:
\itemize{
\item The incidental parameter problem (number of parameters grows with N)
\item Nonlinearity of quantiles
\item Penalization of subject-specific intercepts
}

Block resampling cannot be used for bias adjustment because the target parameter
is not computable under the bootstrap distribution. Instead, the wild bootstrap
generates data under a distribution where the true parameter equals the estimate
from the observed data, allowing bias estimation.

The recommended approach (Battagliola et al. 2024) combines:
\itemize{
\item Wild bootstrap for bias adjustment
\item Block bootstrap for variance/standard error estimation
}
}

\section{References}{


Battagliola, M.L., Sorensen, H., Tolver, A., & Staicu, A.-M. (2024).
Quantile regression for longitudinal functional data with application to
feed intake of lactating sows. Journal of Agricultural, Biological, and
Environmental Statistics, 30(1), 211-230.
\doi{10.1007/s13253-024-00601-5}

Battagliola, M.L., Sorensen, H., Tolver, A., & Staicu, A.-M. (2022).
A bias-adjusted estimator in quantile regression for clustered data.
Econometrics and Statistics, 23, 165-186.
\doi{10.1016/j.ecosta.2021.07.003}
}

