% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap.R
\name{boot_pred_wild}
\alias{boot_pred_wild}
\title{Wild Bootstrap for Functional Quantile GAM}
\usage{
boot_pred_wild(
  d,
  B,
  seed,
  tau,
  X20,
  X80,
  model,
  multicore = TRUE,
  ncores = 3,
  verbose = TRUE
)
}
\arguments{
\item{d}{A data.frame used to fit the model. Must contain columns:
\describe{
\item{id}{Subject identifier (factor). Observations from the same subject
must share the same id.}
\item{y}{Response variable (numeric)}
\item{time}{Longitudinal time stamps (integer or numeric)}
\item{Xobs}{Matrix of functional covariate observations (n x S matrix,
where S is the number of functional grid points)}
\item{sMat}{Matrix of functional domain coordinates (n x S matrix)}
\item{tMat}{Matrix of longitudinal time coordinates (n x S matrix)}
}}

\item{B}{Integer. Number of bootstrap iterations. Battagliola et al. (2024)
use B = 100 in their application.}

\item{seed}{Integer. Random seed for reproducibility.}

\item{tau}{Numeric. Quantile level in (0,1). Should match the quantile
level used in the fitted model.}

\item{X20}{Numeric vector of length S. Point-wise lower reference curve
(e.g., 0.2 quantile of functional covariates).}

\item{X80}{Numeric vector of length S. Point-wise upper reference curve
(e.g., 0.8 quantile of functional covariates).}

\item{model}{A fitted \code{qgam} model object.}

\item{multicore}{Logical. If \code{TRUE}, uses parallel computation in
\code{qgam}. Default is \code{TRUE}.}

\item{ncores}{Integer. Number of cores for parallel computation.
Default is 3.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages.
Default is \code{TRUE}.}
}
\value{
A list of class \code{"fqgam_boot"} with components:
\describe{
\item{pred20}{Matrix (B x maxT) of predicted quantiles at each
longitudinal time for X20}
\item{pred80}{Matrix (B x maxT) of predicted quantiles at each
longitudinal time for X80}
\item{predDiff}{Matrix (B x maxT) of differences \eqn{\hat{Q}_{20}^\tau(t) - \hat{Q}_{80}^\tau(t)}}
\item{seed}{The random seed used}
\item{d}{The input data.frame}
\item{tau}{The quantile level}
\item{running_time}{Vector of execution times (in seconds) for each iteration}
\item{bootstrap_type}{"wild"}
}
}
\description{
Performs wild bootstrap inference for functional quantile regression models
fitted with \code{\link[qgam]{qgam}}. This method combines standard resampling
of estimated random effects with wild bootstrap of residuals, and is primarily
used for bias adjustment.
}
\details{
\strong{Purpose:}
Wild bootstrap is used for bias adjustment of the quantile regression
estimators. As documented in Battagliola et al. (2022), estimators can be
severely biased when clusters are small.

\strong{Algorithm:}
For each bootstrap iteration b = 1, ..., B:
(1) Extract estimated terms and residuals from the fitted model.
(2) Resample random effects with replacement from the estimated values.
(3) Generate wild bootstrap weights w independently from a two-point
distribution: w = 2(1-tau) with probability (1-tau), and w = -2\emph{tau
with probability tau. This distribution has tau-quantile equal to 0.
(4) Create bootstrap responses: Y} = fitted_fixed + u* + w*|residual|.
(5) Fit the model to (Y*, X, t) and compute predictions.
}
\references{
Battagliola, M.L., Sorensen, H., Tolver, A., & Staicu, A.-M. (2022).
A bias-adjusted estimator in quantile regression for clustered data.
Econometrics and Statistics, 23, 165-186.
}
\seealso{
\code{\link{boot_pred_block}} for block bootstrap (variance estimation),
\code{\link{boot_ci}} for computing confidence intervals
}
