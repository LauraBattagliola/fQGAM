% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{predict_fqgam}
\alias{predict_fqgam}
\title{Compute Predictions from Functional Quantile GAM}
\usage{
predict_fqgam(
  model,
  Xref,
  t_range = NULL,
  exclude = "s(id)",
  s_range = c(0, 1)
)
}
\arguments{
\item{model}{A fitted \code{qgam} model object.}

\item{Xref}{Matrix or list of numeric vectors. Reference curves at which
to compute predictions. If a list, each element should be a numeric
vector of the same length as the functional grid.}

\item{t_range}{Integer vector. Longitudinal time points at which to predict.
Default is \code{NULL}, which uses \code{1:max(time)} from the model data.}

\item{exclude}{Character. Terms to exclude from predictions.
Default is \code{"s(id)"} to exclude random effects.}

\item{s_range}{Numeric vector of length 2. Range of the functional domain.
Default is \code{c(0, 1)}.}
}
\value{
A list of class \code{"fqgam_pred"} containing:
\describe{
\item{predictions}{Named list of prediction vectors, one per reference curve}
\item{time}{Vector of time points}
\item{Xref}{The reference curves used}
}
}
\description{
Computes predicted quantiles at specified reference curves and
longitudinal time points from a fitted \code{qgam} model.
}
\details{
The predicted quantile at reference curve \eqn{X(s)} and time \eqn{t} is:
\deqn{\hat{Q}_{X,0}^\tau(t) = \hat{\alpha}^\tau(t) + \int_S X(s) \hat{\beta}^\tau(s,t) ds}

The integral is approximated as a Riemann sum. Note that random effects are
excluded from predictions (setting \eqn{u_i = 0}), so these represent the
quantile for a "typical" subject.
}
