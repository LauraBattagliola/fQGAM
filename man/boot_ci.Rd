% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{boot_ci}
\alias{boot_ci}
\title{Compute Bootstrap Confidence Intervals}
\usage{
boot_ci(
  block_boot,
  wild_boot = NULL,
  original_pred,
  model_se = NULL,
  alpha = 0.05,
  method = c("normal", "percentile", "basic")
)
}
\arguments{
\item{block_boot}{A block bootstrap result object from \code{\link{boot_pred_block}}.
Used for variance/SE estimation.}

\item{wild_boot}{Optional. A wild bootstrap result object from \code{\link{boot_pred_wild}}.
Used for bias adjustment. If \code{NULL}, no bias adjustment is performed.}

\item{original_pred}{Numeric vector. Original (non-bootstrap) predictions.}

\item{model_se}{Optional. Numeric vector of model-based standard errors.}

\item{alpha}{Numeric. Significance level for confidence intervals.
Default is 0.05 for 95\\% CIs.}

\item{method}{Character. One of \code{"normal"}, \code{"percentile"}, or \code{"basic"}.}
}
\value{
A list of class \code{"fqgam_ci"} containing:
\describe{
\item{estimate}{Original or bias-adjusted point estimate}
\item{bias}{Estimated bias}
\item{se_boot}{Bootstrap standard error}
\item{se_model}{Model-based standard error (if provided)}
\item{ci_lower}{Lower confidence bound}
\item{ci_upper}{Upper confidence bound}
\item{alpha}{Significance level}
\item{method}{Method used}
\item{bias_adjusted}{Logical indicating if bias adjustment was applied}
}
}
\description{
Computes confidence intervals from bootstrap results, combining wild bootstrap
for bias adjustment and block bootstrap for variance estimation as recommended
in Battagliola et al. (2024).
}
\details{
\strong{Recommended Approach:}
The recommended approach combines wild bootstrap for bias adjustment and
block bootstrap for standard error estimation. The approximate (1-alpha)
confidence interval is: theta - bias +/- z * sd_boot, where bias is estimated
from wild bootstrap and sd_boot from block bootstrap.

\strong{Alternative Methods:}
Three methods are available: "normal" (uses normal approximation with
bootstrap SE), "percentile" (uses quantiles of bootstrap distribution
directly), and "basic" (uses basic bootstrap intervals with reflected
percentiles).

Model-based standard errors from qgam tend to underestimate the true
sampling variation due to penalization of random effects.
}
\references{
Battagliola, M.L., Sorensen, H., Tolver, A., & Staicu, A.-M. (2024).
Quantile regression for longitudinal functional data with application to
feed intake of lactating sows. Journal of Agricultural, Biological, and
Environmental Statistics, 30(1), 211-230.
}
